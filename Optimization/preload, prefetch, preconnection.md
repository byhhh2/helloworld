# ë¯¸ë¦¬ ì¢€ ê°€ì ¸ì™€ì¤„ë˜ ?

**ìš”ì²­ ìš°ì„ ìˆœìœ„ ì¡°ì •**

> **<link> íƒœê·¸ì˜ rel ì†ì„±**
> 
> - í˜„ì¬ ë¬¸ì„œì™€ ì™¸ë¶€ ë¦¬ì†ŒìŠ¤ ì‚¬ì´ì˜ ì—°ê´€ ê´€ê³„ë¥¼ ëª…ì‹œí•œë‹¤.
> - rel ì†ì„±ì€ ë°˜ë“œì‹œ ëª…ì‹œë˜ì–´ì•¼ í•˜ëŠ” í•„ìˆ˜ ì†ì„±ì´ë‹¤.

## Preload

> ğŸ’¬Â ë¯¸ë¦¬ ì¢€ ê°€ì ¸ì™€ì¤„ë˜?
> 
> 
> ìš°ì„ ìˆœìœ„ : `high`
> 
> í•„ìˆ˜ ì†ì„± : rel, as, crossorigin (fontì¼ ê²½ìš°) 
> 

```html
<link rel="preload" href="<%= PUBLIC_URL %>/static/font.woff2" as="font" type="font/woff2" crossorigin />

<!-- as : ë¦¬ì†ŒìŠ¤ì˜ ìœ í˜• ëª…ì‹œ -->
```

í˜„ì¬ í˜ì´ì§€ì—ì„œ ë°”ë¡œ í•„ìš”í•œ ë¦¬ì†ŒìŠ¤ë¡œ, ë¹ ë¥´ê²Œ ê°€ì ¸ì™€ì•¼ í•œë‹¤ëŠ” ê²ƒì„ ë¸Œë¼ìš°ì €ì—ê²Œ ì•Œë¦°ë‹¤.   
ë¸Œë¼ìš°ì €ê°€ as ì†ì„±ê³¼ ëŒ€ìƒì˜ ìš°ì„ ìˆœìœ„ì— ë”°ë¼ í˜„ì¬ íƒìƒ‰ì— ì‚¬ìš©í•  í•´ë‹¹ ë¦¬ì†ŒìŠ¤ë¥¼ ë¯¸ë¦¬ ê°€ì ¸ì™€ ìºì‹œí•˜ë„ë¡ ëª…ì‹œ   

### íŠ¹ì§•

- fetchëŠ” í•˜ì§€ë§Œ, ë°”ë¡œ excute í•˜ì§„ ì•ŠëŠ”ë‹¤. (ìŠ¤í¬ë¦½íŠ¸ë¥¼ ë¯¸ë¦¬ ë°›ì•„ì™€ë„ ì‹¤í–‰ì€ ë‚˜ì¤‘ì— í•œë‹¤.)
- onload ì´í›„ 3ì´ˆ ì´ë‚´ì— preloadí•œ ë¦¬ì†ŒìŠ¤ë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šì„ ê²½ìš° í¬ë¡¬ì—ì„œ ê²½ê³  ë¡œê·¸ ë°œìƒ
- ë°›ì•„ì˜¨ ë’¤ì— ë¸Œë¼ìš°ì €ì— ìºì‹œí•œë‹¤.

### ì‚¬ìš©ì²˜

- í°íŠ¸
- ì´ˆê¸° ë Œë”ë§ì— ë°˜ë“œì‹œ í•„ìš”í•œ ë¦¬ì†ŒìŠ¤ (critical rendering path)

> **<link> íƒœê·¸ì˜ as ì†ì„±**
> 
> 
> 
> - rel = preload ë˜ëŠ” rel = prefetch íŠ¹ì„±ì„ ì§€ì •í–ˆì„ ë•Œë§Œ ì‚¬ìš©
> - rel = preloadëŠ” as íŠ¹ì„±ì„ ì‚¬ìš©í•´ ìš”ì²­ ìš°ì„  ìˆœìœ„ë¥¼ ë§¤ê¸´ë‹¤.

> **crossorigin**
> 
> 
> [why do we need crossorigin when preloading font](https://stackoverflow.com/questions/70183153/why-do-we-need-the-crossorigin-attribute-when-preloading-font-files)
> 
> - ë¦¬ì†ŒìŠ¤ë¥¼ ê°€ì ¸ì˜¬ ë•Œ CORSë¥¼ ì‚¬ìš©í•´ì•¼ í•˜ëŠ”ì§€ ë‚˜íƒ€ë‚´ëŠ” íŠ¹ì„±
> - fontëŠ” crossorigin ì†ì„±ì„ í¬í•¨í•˜ì§€ ì•Šì•˜ì„ ë•Œ fontë¥¼ ë‘ë²ˆ ì¤‘ë³µí•´ì„œ ê°€ì ¸ì˜¨ë‹¤.
>     - ì†ì„±ì´ ì—†ìœ¼ë©´ ë¸Œë¼ìš°ì €ì—ì„œ ë¯¸ë¦¬ ë¡œë“œëœ ê¸€ê¼´ì„ ë¬´ì‹œí•œë‹¤.
>     - fetchê°€ êµì°¨ ì¶œì²˜ê°€ ì•„ë‹Œ ê²½ìš°ì—ë„ crossorigin ì†ì„±ì„ ì„¤ì •í•´ì•¼í•œë‹¤.
>     - ì™œ? ë ˆê±°ì‹œ ë¦¬ì†ŒìŠ¤ ìœ í˜•ì„ ì§€ì›í•´ì•¼ í•˜ëŠ” ìµœì‹  ê¸°ëŠ¥ì´ê¸° ë•Œë¬¸ì—

> **Critical Rendering Path**
> 
> 
> 
> ë¸Œë¼ìš°ì €ê°€ HTML, CSS, Javascriptë¥¼ í™”ë©´ì— í”½ì…€ë¡œ ë³€í™”í•˜ëŠ” ì¼ë ¨ì˜ ë‹¨ê³„
> 
> - ì´ë¥¼ ìµœì í™”í•˜ëŠ” ê²ƒì€ ë Œë”ë§ ì„±ëŠ¥ì„ í–¥ìƒì‹œí‚¨ë‹¤.
> - DOM, CSSOM, render tree, Layoutì„ í¬í•¨í•œë‹¤.

## Prefetch

> ğŸ’¬Â ë‚˜ì¤‘ì— ì“°ì¼ ê²ƒ ê°™ì€ë°, ë¯¸ë¦¬ ì¢€ ê°€ì ¸ì™€ì¤„ë˜ ?
> 
> 
> ìš°ì„ ìˆœìœ„ : `low`
> 

ë¸Œë¼ìš°ì €ì—ê²Œ ë¯¸ë˜ì— í•„ìš”í•  ìˆ˜ ìˆëŠ” í˜ì´ì§€, ë¦¬ì†ŒìŠ¤(script, css) ë“±ì„ ë¯¸ë¦¬ ë‹¤ìš´ë¡œë“œ ë°›ì•„ë‘ë¼ê³  ì•Œë ¤ì£¼ëŠ” ê²ƒ 

### íŠ¹ì§•

- í˜„ì¬ í˜ì´ì§€ê°€ ë‹¤ ë¡œë“œëœ ì´í›„ í›„ìˆœìœ„ë¡œ ë°›ì•„ì„œ prefetch cacheì— ë„£ëŠ”ë‹¤.
- í˜„ì¬ í˜ì´ì§€ ë¡œë“œ ì‹œê°„ì—ëŠ” ì˜í–¥ì„ ë¯¸ì¹˜ì§€ ì•Šì§€ë§Œ, ë‹¤ìŒ navigationì˜ FCPë‚˜ TTIì— ì˜í–¥ì„ ë¯¸ì¹œë‹¤.
    - í›„ì† í˜ì´ì§€ ë¡œë“œ ì‹œê°„ì„ ê°œì„ í•  ìˆ˜ ìˆë‹¤.
    - ex) ì‚¬ìš©ì ì¸ì¦ ì¤‘ì— ë‹¤ìŒ í˜ì´ì§€ë¥¼ ë¯¸ë¦¬ ë¡œë“œ í•œë‹¤.
    - **FCP** : ìµœì´ˆ ì»¨í…ì¸ í’€ í˜ì¸íŠ¸ (First Contentful Paint), í˜ì´ì§€ê°€ ë¡œë“œë˜ê¸° ì‹œì‘í•œ ì‹œì ë¶€í„° í˜ì´ì§€ ì»¨í…ì¸ ì˜ ì¼ë¶€ê°€ í™”ë©´ì— ë Œë”ë§ ë  ë•Œê¹Œì§€ì˜ ì‹œê°„
    - **TTI** : ìƒí˜¸ ì‘ìš©ê¹Œì§€ì˜ ì‹œê°„ (Time To Interactive), í˜ì´ì§€ê°€ ë¡œë“œë˜ê¸° ì‹œì‘í•œ ì‹œì ë¶€í„°, ì‚¬ìš©ì ì…ë ¥ì— ì•ˆì •ì ìœ¼ë¡œ ì‘ë‹µí•  ìˆ˜ ìˆëŠ” ì‹œì ê¹Œì§€ì˜ ì‹œê°„
- ì´ˆê¸° ë Œë”ë§ì—ì„  í•„ìš”ì—†ëŠ” ë¦¬ì†ŒìŠ¤ë¥¼ ë¶ˆëŸ¬ì˜¬ ë•Œ ì‚¬ìš©

### ì‚¬ìš©ì²˜

- ì´ˆê¸° ë Œë”ë§ì—ì„œ í•„ìš”ì—†ëŠ” ë¦¬ì†ŒìŠ¤
- ê°™ì€ ì–´í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ë‹¤ë¥¸ í˜ì´ì§€ì— ì‚¬ìš©ë˜ëŠ” JS ë²ˆë“¤
- í˜„ì¬ í˜ì´ì§€ì—ì„œ ì“°ì´ë”ë¼ë„ ì´ˆê¸° ë Œë”ë§ì—ëŠ” í•„ìš”ì—†ëŠ” ë¦¬ì†ŒìŠ¤ì¸ ëª¨ë‹¬

## Preconnect

> ğŸ’¬Â ì—°ê²°ë§Œ ë¯¸ë¦¬ í•´ë†“ì„ê¹Œ ?
> 
> 
> ìš°ì„ ìˆœìœ„ : `low`
> 

ë¸Œë¼ìš°ì €ì—ì„œ ì„œë²„ì™€ ì—°ê²°ë§Œ ë¯¸ë¦¬ ë§ºì–´ë‘ê³  ìˆì–´ ë‹¬ë¼ê³  ì•Œë ¤ì£¼ëŠ” ê²ƒ 

<img width="634" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-11-09 á„‹á…©á„Œá…¥á†« 1 29 12" src="https://user-images.githubusercontent.com/52737532/200630389-576d1382-7da6-4aa9-adce-dd27cc99a93c.png">

ë¦¬ì†ŒìŠ¤ë¥¼ ê°€ì ¸ì˜¤ê¸° ìœ„í•´ì„œëŠ” ì—°ê²°ì„ í•˜ê³  ë‹¤ìš´ë¡œë“œí•˜ëŠ” ê³¼ì •ì´ í•„ìš”í•˜ë‹¤.   
(ì—°ê²° : ë„ë©”ì¸ ì´ë¦„ì„ ì°¾ì•„ IP ì£¼ì†Œ í™•ì¸ â†’ ì„œë²„ì— ëŒ€í•´ ì—°ê²° ì„¤ì • â†’ ë³´ì•ˆ ìœ„í•´ ì—°ê²° ì•”í˜¸í™”)   

### íŠ¹ì§•

- ê°œë³„ ìš”ì²­ë‹¹ 100~500ms ì •ë„ ë¡œë“œ ì‹œê°„ì„ ì ˆì•½í•  ìˆ˜ ìˆë‹¤.

### ì‚¬ìš©ì²˜

- ì™¸ë¶€ ë„ë©”ì¸ ë¦¬ì†ŒìŠ¤ (í°íŠ¸)

# ì´ê±´ ë°”ë¡œëŠ” í•„ìš” ì—†ì–´

ìë°”ìŠ¤í¬ë¦½íŠ¸ : **íŒŒì„œ ì°¨ë‹¨ ë¦¬ì†ŒìŠ¤** (parser blocking resource) 

![Untitled (11)](https://user-images.githubusercontent.com/52737532/200630569-26d19c9a-0d48-4f8b-91a5-cb58d5a5c6d0.png)

![Untitled (12)](https://user-images.githubusercontent.com/52737532/200630589-85ef50ed-d6fb-4770-a9fa-5c565a2820c1.png)


## defer

- HTML parsingì— script fetch, execution ë‘˜ ë‹¤ ì˜í–¥ê°€ì§€ ì•Šê²Œ í•œë‹¤.
    - fetchëŠ” parsing ë„ì¤‘ì— ì§„í–‰ëœë‹¤. (parsingì€ ë©ˆì¶”ì§€ ì•ŠëŠ”ë‹¤.)
- HTML parsingì´ ëë‚  ë•Œê¹Œì§€ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ì„ ì§€ì—°í•œë‹¤.
- headì— scriptê°€ ìˆì–´ë„ ì „ì²´ DOMì´ êµ¬ì„±ëœ ì´í›„ì— ì‹¤í–‰

```html
defer script fetch -> DOMContentLoaded -> defer script execute 
```

> `load`ëŠ” ëª¨ë“  ë¦¬ì†ŒìŠ¤(CSS, images..)ê°€ ë‹¤ìš´ë¡œë“œëœ ë‹¤ìŒì— í˜¸ì¶œë˜ê³ ,
> 
> 
> `DOMContentLoaded`ëŠ” HTML documentë¥¼ ì „ë¶€ ì½ê³  DOMíŠ¸ë¦¬ë¥¼ ì™„ì„±í•˜ëŠ” ì¦‰ì‹œ ì´ë²¤íŠ¸ê°€ í˜¸ì¶œëœë‹¤.
> 

## async

- HTML parsingì— fetchë§Œ ì˜í–¥ê°€ì§€ ì•ŠëŠ”ë‹¤. (excutionì€ ì˜í–¥ê°„ë‹¤.)
- fetchingì´ ì™„ë£Œë˜ë©´ HTML parsing ì¤‘ê°„ì— ìŠ¤í¬ë¦½íŠ¸ê°€ ì‹¤í–‰ë  ìˆ˜ ìˆë‹¤.
- ê´‘ê³  ë“± ë¬¸ì„œ ë‚´ìš©ì´ë‚˜ ì•± ìì²´ì™€ëŠ” ê´€ë ¨ ì—†ì´ ë…ë¦½ì ìœ¼ë¡œ ë™ì‘í•˜ëŠ” ìŠ¤í¬ë¦½íŠ¸ì— ì‚¬ìš©í•œë‹¤.

## ì°¸ê³ 

- [tcpschool - link.rel](http://www.tcpschool.com/html-tag-attrs/link-rel)
- ìš°ì•„í•œí…Œí¬ì½”ìŠ¤ LMS
- ë°§ë“œì˜ preload, prefetch, preconnection
- [critical rendering path](https://developer.mozilla.org/ko/docs/Web/Performance/Critical_rendering_path)
- [as, crossorigin](https://developer.mozilla.org/ko/docs/Web/HTML/Element/link#attr-as)
- [fcp](https://web.dev/i18n/ko/fcp/)
- [https://web.dev/preconnect-and-dns-prefetch/](https://web.dev/preconnect-and-dns-prefetch/)
- [https://web.dev/preconnect-and-dns-prefetch/](https://web.dev/preconnect-and-dns-prefetch/)
- [DOMContentLoaded, load](https://yelee.tistory.com/13)
